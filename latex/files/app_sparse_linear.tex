\begin{proof}[Proof of Claim \ref{claim:apple}] We show that in this case, a
``scaling'' mutation achieves the desired result. Restricted to the direction
$w$, the best approximation to $f^S$ is $\frac{\ip{f^S}{w}}{\ltwonorm{w}^2}w$.
We have that
%%
\[
\left\Vert \frac{\ip{f^S}{w}}{\ltwonorm{w}^2} w \right\Vert \leq
\ltwonorm{f^S} \leq \frac{\ltwonorm{w}}{2}
\]
%%
Hence, if $\ip{f^S}{w} > 0$, for $\gamma \in [1/4, 3/4]$ (and similarly if
$\ip{f^S}{w} < 0$ for $\gamma \in [-3/4, -1/4]$ ), we have that
%%
\begin{align*}
\ltwonorm{f^S - \gamma w}^2 &= \ltwonorm{f^S - w}^2 + 2 (1 - \gamma) \ip{f^S -
w}{w} + (1 - \gamma)^2 \ltwonorm{w}^2 \\
&\leq \ltwonorm{w - f^S}^2 - (1 - \gamma) \ltwonorm{w}^2 + (1 - \gamma)^2
\ltwonorm{w}^2 \\
&= \ltwonorm{w - f^S}^2 - (\gamma - \gamma^2) \ltwonorm{w}^2
\intertext{Finally, by observing that for $\gamma \in [1/4, 3/4]$, $\gamma -
\gamma^2 \geq 3/16$ and that by the triangle inequality, $\ltwonorm{w} \geq
(2/3)\ltwonorm{f^S - w}$ when $\ltwonorm{w} \geq 2 \ltwonorm{f^S}$, we obtain}
%
\ltwonorm{f^S - \gamma w}^2 &\leq \ltwonorm{f^S - w}^2 - \frac{1}{12}
\ltwonorm{f^S - w}^2
\end{align*}
We note that $\loss_{f, D}(w^\prime) = \ltwonorm{f - f^S}^2 + \ltwonorm{f^S -
\gamma w}^2$ and $\loss_{f, D}(w) = \ltwonorm{f - f^S}^2 + \ltwonorm{f^S -
w}^2$. An appropriate value of $\gamma$ is chosen with probability at least
$1/4$, and combined with the probability of choosing a scaling mutation we get
the desired result.
\end{proof}

\begin{proof}[Proof of Claim~\ref{claim:banana}] Here, we appeal to a mutation
that adjusts the relative weights of the variables within the set $S = \NZ(w)$.
Consider the vector $f^S - w$, and note that $\NZ(f^S -w ) \subseteq S$. Let
$r^S = f^S - w$ denote the residual, which lies in the space spanned by $S$.
Now consider
\begin{align*}
\ltwonorm{r_S}^2 = \ip{r^S}{r^S} &= \sum_{i \in S} r^S_i \ip{e^i}{r^S}
\intertext{Here, $e^i$ is the unit vector representing the linear function $x
\mapsto e^i \cdot x = x_i$. Therefore, there must exist an $i$ for which the
following is true:}
r^S_i\ip{e^i}{r^S} &\geq \frac{\ltwonorm{r^S}^2}{|S|}
\intertext{We appeal to Lemma~\ref{lemma:amsterdam} (part 1), which implies that
$|r^S_i| \leq \sqrt{\ip{r^S}{r^S}/\Delta^2} = \ltwonorm{r^S}/{\Delta}$, to
conclude that}
|\ip{e^i}{r^S}| &\geq \frac{\ltwonorm{r^S} \Delta}{|S|}
\end{align*}
Let $\beta = \frac{\ip{e^i}{r^S}}{\ltwonorm{e^i}^2}$ and suppose $w^\prime =
w + \gamma e^i$ for $\gamma \in [\beta - |\beta|/2, \beta +  |\beta|/2]$. We
then have
\begin{align*}
\ltwonorm{f^S - (w + \gamma e^i)}^2 &= \ltwonorm{f^S - w}^2 - 2 \gamma \ip{f^S -
w}{e^i} + \gamma^2 \ltwonorm{e^i}^2
%
\intertext{Recall that $f^S - w = r^S$ and note that $\ip{e^i}{r^S}$ and
$\gamma$ have the same sign. This, combined with the above equation, gives}
%
\ltwonorm{f^S - (w + \gamma e^i)}^2 &= \ltwonorm{f^S - w}^2 - (2
|\gamma||\beta| - \gamma^2) \ltwonorm{e^i}^2
\intertext{Finally, note that for $|\gamma| \in [|\beta|/2, 3|\beta|/2]$, $- 2
|\gamma| |\beta| + \gamma^2 \leq - 3 |\beta|^2/4$, hence, the
above equation and the fact that $\ltwonorm{e^i} \leq 1$ together yield}
\ltwonorm{f^S - (w + \gamma e^i)}^2 &\leq \ltwonorm{f^S - w}^2 - \frac{3}{4}
\beta^2 \ltwonorm{e^i}^2 \leq \ltwonorm{f^S - w}^2 - \frac{3}{4}
\frac{\ltwonorm{f^S - w}^2 \Delta^2}{|S|^2}
\end{align*}

Note that a suitable mutation $w^\prime = w + \gamma e^i$ is obtained with
probability at least $|\beta|/(6KB)$ ($1/3$ for choosing the right type of
mutation, $1/K$ for the correct choice of variable, and $|\beta|/(2B)$ for the
choosing the correct value of $w_i$).  Also note that
$|\beta| \geq \Delta \ltwonorm{f^S - w} / |S| \geq \Delta \ltwonorm{f^S - w} / K$.
For this to be a valid mutation, we also need to verify the fact that $w_i + \gamma
\in [-B, B]$, which is ensured by our choice of $B$. To see this, note that
$\ltwonorm{w} \leq 2 \ltwonorm{f^S} \leq 2 \ltwonorm{f}$ (the last part is
because $f^S$ is a projection of $f$ onto a lower dimensional space). Thus, by
Lemma~\ref{lemma:amsterdam} (part 1), $w_i \leq 2 \ltwonorm{f} / \Delta$. Also,
$|\beta| = |\ip{e^i}{r^S}|/\ltwonorm{e^i}^2 \leq \ltwonorm{r^S}/\ltwonorm{e^i}
= \ltwonorm{f^S - w}/\E[x_i^2] \leq 3 \ltwonorm{f}/\Delta$.
Thus, if $B > 13 \ltwonorm{f}/ (2\Delta)$, then $|w_i + \gamma| < B$ and the
mutation will be a valid one. Note that the maximum value of $\ltwonorm{f}$ for
$f \in \lin^k_{l, u}$ is $ku$. Thus, our choice of $B = 10 ku / \Delta$ is
sufficient.  This completes the proof of Claim~\ref{claim:banana}.
\end{proof}

\begin{proof}[Proof of Claim~\ref{claim:cantaloupe}] Finally, we show that if
$\ltwonorm{f^S - w}$ is very small, but $\NZ(f) \not\subseteq S$, then it must
be the case that a ``swapping'' or ``adding'' mutation is beneficial. We focus
on the swapping case, \ie when $|S| = K$; the adding step is a special case of
this. First, we observe that if there exists $i \in \NZ(f)$ such that $i \not\in
S$, then by using Lemma~\ref{lemma:amsterdam} (part 1), it must be the case that
$\ltwonorm{f - w}^2 \geq (f_i - w_i)^2 \Delta^2 = f_i^2 \Delta^2 \geq l^2 \Delta^2$.
Let $r = f - w$ denote the residual. Then, consider the following:
%%
\begin{align}
%
\ip{r}{r} &=  \sum_{i \in \NZ(f) \setminus S} r_i \ip{e^i}{r} + \sum_{i \in S} r_i
\ip{e^i}{r} \nonumber
%
\intertext{Note that for all $i \in S$, $\ip{e^i}{f - f^S} = 0$, since $f^S$ is
the projection of $f$ onto the space spanned by the variables in $S$. Hence, if
$r^S = f^S - w$, the residual within the space spanned by $S$, then $r = f - f^S
+ r^S$. Thus, we have $\ip{e^i}{r} = \ip{e^i}{r^S} \leq \ltwonorm{r^S}$. Using
this we get, }
%
\ip{r}{r} &\leq \sum_{i \in \NZ(f) \setminus S} r_i \ip{e^i}{r} +
\ltwonorm{r^S} \sum_{i \in S} |r_i|  \nonumber
%%
\intertext{Now, even by a very crude estimate, $|r_i| = |f_i - w_i| \leq 2 B$,
and hence by the condition in the statement of Claim~\ref{claim:cantaloupe},
that $\ltwonorm{r^S} =\ltwonorm{f^S - w} \leq l^2\Delta^2/(4KB)$, together with
the previous observation that $\ip{r}{r} = \ltwonorm{r}^2 =
\ltwonorm{f - w}^2 \geq l^2 \Delta^2$, we have that}
%%
\frac{1}{2}\ip{r}{r} &\leq \sum_{i \in \NZ(f) \setminus S} r_i \ip{e^i}{r}
\nonumber
%
\intertext{We now appeal to Lemma~\ref{lemma:amsterdam} (part 1), which shows
that $|r_i| \leq \ltwonorm{r} / \Delta$, and
conclude that there exists an $i$ for which}
%
|\ip{e^i}{r}| &\geq \frac{\ltwonorm{r} \Delta}{2 k} \nonumber
%
\intertext{The crucial observation is that $|\NZ(f)| \leq k < K$. Let $\beta =
\frac{\ip{r}{e^i}}{\ltwonorm{e^i}^2}$. Finally, Lemma~\ref{lemma:amsterdam}
(part 2) implies that there exists an $i^\prime$ for which $w_{i^\prime}^2 \leq
\ltwonorm{w}^2/K$. We consider the mutation, $w^\prime = w + \gamma e^i -
w_{i^\prime} e^{i^\prime}$ for $\gamma \in [\beta - |\beta|/2, \beta +
|\beta|/2]$. Then, we have}
%%
\ltwonorm{f - (w + \gamma e^i - w_{i^\prime} e^{i^\prime})}^2 &= \ltwonorm{f - (w
+ \gamma e^i)}^2 - 2 w_{i^\prime} \ip{f - (w + \gamma e^i)}{e^{i^\prime}} +
w_{i^\prime}^2 \ltwonorm{e^{i^\prime}}^2 \label{eqn:artichoke}
%%
\intertext{We bound the first term on the right hand side of the above expression and then
the latter two.}
%
\ltwonorm{f - (w + \gamma e^i)}^2 &= \ltwonorm{r}^2 - 2 \gamma \ip{r}{e^i} +
\gamma^2 \ltwonorm{e^i}^2 \nonumber \\
&= \ltwonorm{r}^2 - (2 \gamma \beta  - \gamma^2) \ltwonorm{e^i}^2 \nonumber
%
\intertext{As in the proof of Claim~\ref{claim:banana}, for $|\gamma| \in
[|\beta|/2, 3|\beta|/2]$, we have that $- 2 \gamma \beta + \gamma^2 \leq -
3 \beta^2/4$. Hence,}
\ltwonorm{f - (w + \gamma e^i)}^2 &\leq \ltwonorm{r}^2 - \frac{3}{4} \beta^2
\label{eqn:broccoli}
%%
\intertext{To bound the remaining two terms in (\ref{eqn:artichoke}), recall that
$f - w = f - f^S + r^S$ and that $\ip{f - f^S}{e^{i^\prime}} = 0$
(since $i^\prime \in S$). Thus, we get that}
%%
- 2 w_{i^\prime} \ip{f - (w + \gamma e^i)}{e^{i^\prime}} + w_{i^\prime}^2
  \ltwonorm{e^{i^\prime}}^2 &\leq 2 |w_{i^\prime}| |\ip{r^S + \gamma
  e^i}{e^{i^\prime}}| + w_{i^\prime}^2 \ltwonorm{e^{i^\prime}}^2 \nonumber
\intertext{Using the fact that $\ltwonorm{r^S} \leq \gamma$, $|w_{i^\prime}|< \gamma$
\eanote{(which we will show below)}, $|\ip{e^i}{e^{i^\prime}}| \leq 1$ and
$\ltwonorm{e^{i^\prime}} \leq 1$, we obtain}
%%
- 2 w_{i^\prime} \ip{f - (w + \gamma e^i)}{e^{i^\prime}} + w_{i^\prime}^2
  \ltwonorm{e^{i^\prime}}^2 &\leq 6 |w_{i^\prime}||\gamma| \label{eqn:cabbage}
%%
\intertext{Recall that $|w_{i^\prime}| \leq \ltwonorm{w}/\sqrt{K}$. Also $\ltwonorm{w}
\leq \ltwonorm{f^S} + \ltwonorm{r^S} \leq 2 \ltwonorm{f^S} \leq 2 \ltwonorm{f}
\leq 2uk$, where we have used the fact that $\ltwonorm{r^S}$ is small. Combining
(\ref{eqn:artichoke}), (\ref{eqn:broccoli}),  (\ref{eqn:cabbage}), the fact that
$|w_i| \leq 2uk/\sqrt{K}$ and $|\gamma| \leq 3 |\beta|/2$, we get}
%%
\ltwonorm{f - (w + \gamma e^i - w_{i^\prime} e^{i^\prime})}^2 &\leq
\ltwonorm{r}^2 - \frac{3}{4} \beta^2 + 18 |\beta|uk/\sqrt{K} \nonumber
%%
\end{align}
\eanote{Checked this far.}
Finally, we note that when $K > 5184 (k/\Delta)^4 (u/l)^2$, the above
equation ensures that the expected loss drops by at least $\beta^2/4$.  The probability of
choosing a swapping operations is $1/3$, of subsequently choosing the correct
pair is at least $1/(nK)$, and subsequently choosing the correct value of $w_i$
is at least $|\beta|/(2B)$. A simple calculation proves the statement of the
claim.
\end{proof}
